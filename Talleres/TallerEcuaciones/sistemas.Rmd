---
title: "sistema de ecuaciones lineales iterativos"
output:
  html_notebook: default
  html_document:
    df_print: paged
  pdf_document: default
---
##Ejercicios
```{r}
library(pracma)
library(Matrix)
```
```{r}
setwd("C:\Users\kjuli\Downloads\Talleres\Taller Ecuaciones")
```

1. Para el siguiente ejercico, instale el paquete "pracma" 
a. Revise las siguientes funciones con la matriz del ejercicio 2
b. Evalue la matriz de transici贸n para el m茅todo $\textbf{SOR}$
```{r,echo=T}
D1<-eye(n, m = n)
D2<-ones(n, m = n)
D3<-zeros(n, m = n)
```
2. Dada la siguiente matriz, utilice las funciones del paquete para descomponer la matriz $A=L+D+U$ (Jacobi)
```{r, echo=FALSE}
A = matrix(c(-8.1, -7, 6.123, -2, -1, 4,
-3, -1, 0, -1, -5, 0.6,
-1, 0.33, 6, 1/2), nrow=4, byrow=TRUE)
A
```
b. Utilice la funci贸n itersolve(A, b, tol , method = "Gauss-Seidel") y solucionar el sistema asociado a la matriz $A$ con $b=[1.45,3,5.12,-4]^{t}$ con una tolerancia de $1e^-9$
c. Genere 5 iteraciones del m茅todo de Jacobi, calcular error relativo para cada iteracion

3. Sea el sistema $AX=b$ 
 a. Implemente una funci贸n en R para que evalue las ra铆ces del polinomio caracter铆stico asociado a la matriz $A$
 b. Use el teorema de convergencia para determinar cu谩l m茅todo iterativo es m谩s favorable.
 c. Evalue la matriz de transici贸n para cada caso y en el caso del m茅todo de relajaci贸n determine el valor 贸ptimo de $\omega$
 d. Teniendo en cuenta lo anterio resolver el sistema

```{r, echo=T}
A = matrix(c(4, -1, -1, -1, -1, 4,
-1, -1, -1, -1, 4, -1,
-1, -1, -1, 4), nrow=4, byrow=TRUE)
A
b = c(1, 5, 1.5,-2.33)
b
```
d Comparar con la soluci贸n por defecto
```{r,echo=T}
solucion<- solve(A,b)

```
3. 
a. Pruebe el siguiente algoritmo con una matriz $A_{3}$, modifiquelo para quue $a_{ii}=0$ para todo $i$
```{r, echo=T}
tril1 <- function(M, k = 0) {
if (k == 0) {
M[upper.tri(M, diag = FALSE)] <- 0
} else {
M[col(M) >= row(M) + k + 1] <- 0
}
return(M)
}
```
b. Implemente una funci贸n en R para que dada una matriz $A$ se obtenga una matriz diagonal $D$ donde en la diagonal estan los mismo elementos de A

4. Cree una funci贸n que cuente el n煤mero de multiplicaciones en el m茅todo directo de Gauss Jordan, para resolver un sistema de $n$ ecuaciones y pruebelo para $n=5$

5. Dado el siguiente sistema:

    $2x-z=1$                                                                                
    $\beta$x+2y-z=2                                                                         
    $-x+y+$\alpha$z=1$

a. Encuentre el valor de $\alpha$ y $\beta$ para asegura la convergencia por el m茅todo de Jacobi
b. Genere una tabla que tenga 10 iteraciones del m茅todo de Jacobi con vector inicial $x_{0}=[1,2,3]^t$
c. Grafique cada ecuaci贸n y la so帽luci贸n

6. Instalar el paquete Matrix y descomponga la matriz $A$ (del punto dos) de la forma $LU$ y la factorizarla como $A=QR$

7.
a. Determinar num茅ricamente la intersecci贸n entre la circunferencia $x^2 + y^2 = 1$ y la recta $y = x$. Usamos una aproximaci贸n inicial $(1,1)$. Utilice el pauqte BB y  la funci贸n BBsolve() del paquete,grafique la soluci贸n
b Analizar y comentar el siguinte c贸digo
#Barzilai-Borwein se usa para resolver el sistema no lineal de ecuaciones, y para optimizar las funciones objetivas no lineales sujetas a restricciones simples. Es especialmente til en problemas donde los algoritmos son propensos a experimentar dificultades en la convergencia.
```{r, echo=T}
trigexp = function(x) {
n = length(x)
F = rep(NA, n)
F[1] = 3*x[1]^2 + 2*x[2] - 5 + sin(x[1] - x[2]) * sin(x[1] + x[2])
tn1 = 2:(n-1)
F[tn1] = -x[tn1-1] * exp(x[tn1-1] - x[tn1]) + x[tn1] *
( 4 + 3*x[tn1]^2) + 2 * x[tn1 + 1] + sin(x[tn1] -
x[tn1 + 1]) * sin(x[tn1] + x[tn1 + 1]) - 8
F[n] = -x[n-1] * exp(x[n-1] - x[n]) + 4*x[n] - 3
F
}
n = 10000
p0 = runif(n) # n initial random starting guesses
#BBsolve es especialmente til en problemas donde los algoritmos son propensos a experimentar dificultades en la convergencia
sol = BBsolve(par=p0, fn=trigexp)
sol$par
```
8. Demuestre y realice varias pruebas que la matriz de transici贸n por el m茅todo de Gauss-Seidel esta dada por $T=(-D^{-1}U)(I+LD^{-1})^{-1}$
```{r}
#Es un mtodo iterativo que se utiliza para resolver un sistema lineal de ecuaciones. Es similar al mtodo Jacobi. Aunque se puede aplicar a cualquier matriz con elementos distintos de cero en las diagonales, la convergencia slo se garantiza si la matriz es diagonal dominante o simtrica y positiva definida.

library(MASS) # package needed for ginv() function 

A=cbind(c(4,8),c(8,30)) # coefficient matrix
b<-t(t(c(12,39))) # b-vector
x0<-t(t(c(0,0)))  # starting vector
iter<-10          # number of Gauss-Seidel iterations to run

L<-lower.tri(A)*A  # lower triang. A
U<-upper.tri(A)*A  # upper triang. A
D<-diag(diag(A))   # diag of A

# plot points 
xc<-c(0,1,2,5)
yc<-c(0,3,3,6)
plot(xc,yc,
     col='red',
     xlab="X-Values",
     ylab="Y-Values",
     bty='n')
title(main="OLS Estimados")
legend("bottomright",
       c("Datos","Estimados","Linea Original"),
       lty=c(0,1,1),
       pch=c(1,NA,NA),
       col=c("red","blue","green"),
       bty='n')

# create color palette - lines will get darker with each iter
pal<-colorRampPalette(c("#f2f2f2", "Blue"))
colors<-pal(iter) # creates color palette of length(iter)

# plot true line
abline(a=1.0714,b=.8571,col='green')

n<-1
while(n<=iter){
  print(x0)
  
  # Gauss-Seidel formula
  x1<-(ginv((L+D)))%*%((-U%*%x0)+b)
  x0<-x1
  n=n+1
  
  # plot estimated line  
  abline(a=as.numeric(x0[2,1]), # slope of estimated line
         b=as.numeric(x0[1,1]), # y-intercept of estimated line
         col=colors[n]) # pick nth color in palette
}
```

